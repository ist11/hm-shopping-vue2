{"version":3,"file":"js/297.541bde75.js","mappings":"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","sources":["webpack://shopping-vue2/./src/views/login/index.vue","webpack://shopping-vue2/./src/api/login.js","webpack://shopping-vue2/src/views/login/index.vue","webpack://shopping-vue2/./src/views/login/index.vue?ff45","webpack://shopping-vue2/./src/views/login/index.vue?a173"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',[_c('van-nav-bar',{attrs:{\"title\":\"会员登录\",\"left-text\":\"\",\"right-text\":\"\",\"left-arrow\":\"\"},on:{\"click-left\":function($event){return _vm.$router.go(-1)}}}),_c('div',{staticClass:\"container\"},[_vm._m(0),_c('div',{staticClass:\"form\"},[_c('div',{staticClass:\"form-item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.mobile),expression:\"mobile\"}],staticClass:\"inp\",attrs:{\"maxlength\":\"11\",\"placeholder\":\"请输入手机号码\",\"type\":\"text\"},domProps:{\"value\":(_vm.mobile)},on:{\"input\":function($event){if($event.target.composing)return;_vm.mobile=$event.target.value}}})]),_c('div',{staticClass:\"form-item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.picCode),expression:\"picCode\"}],staticClass:\"inp\",attrs:{\"maxlength\":\"5\",\"placeholder\":\"请输入图形验证码\",\"type\":\"text\"},domProps:{\"value\":(_vm.picCode)},on:{\"input\":function($event){if($event.target.composing)return;_vm.picCode=$event.target.value}}}),_c('img',{attrs:{\"src\":_vm.picUrl,\"alt\":\"\"},on:{\"click\":_vm.getPicCode}})]),_c('div',{staticClass:\"form-item\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.msgCode),expression:\"msgCode\"}],staticClass:\"inp\",attrs:{\"placeholder\":\"请输入短信验证码\",\"type\":\"text\"},domProps:{\"value\":(_vm.msgCode)},on:{\"input\":function($event){if($event.target.composing)return;_vm.msgCode=$event.target.value}}}),_c('button',{on:{\"click\":_vm.getCode}},[_vm._v(\" \"+_vm._s(_vm.totalSecond === _vm.second ? '获取验证码' : '重新发送(' + _vm.second + '秒)')+\" \")])])]),_c('div',{staticClass:\"login-btn\",on:{\"click\":_vm.login}},[_vm._v(\" 登录 \")])])],1)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"title\"},[_c('h3',[_vm._v(\"手机号登录\")]),_c('p',[_vm._v(\"未注册的手机号登录后将自动注册\")])])\n}]\n\nexport { render, staticRenderFns }","import request from '@/utils/request'\r\n\r\n// 获取图形验证码\r\nexport const getPicCode = () => {\r\n  return request.get('/captcha/image')\r\n}\r\n\r\n// 2. 获取短信验证码\r\nexport const getMsgCode = (captchaCode, captchaKey, mobile) => {\r\n  return request.post('/captcha/sendSmsCaptcha', {\r\n    form: {\r\n      captchaCode,\r\n      captchaKey,\r\n      mobile,\r\n    },\r\n  })\r\n}\r\n\r\n// 验证码登录\r\nexport const codeLogin = (mobile, smsCode) => {\r\n  return request.post('/passport/login', {\r\n    form: {\r\n      isParty: false,\r\n      mobile,\r\n      partyData: {},\r\n      smsCode,\r\n    },\r\n  })\r\n}\r\n","<template>\n  <div>\n    <div>\n      <van-nav-bar\n        title=\"会员登录\"\n        left-text=\"\"\n        right-text=\"\"\n        left-arrow\n        @click-left=\"$router.go(-1)\"\n      />\n      <div class=\"container\">\n        <div class=\"title\">\n          <h3>手机号登录</h3>\n          <p>未注册的手机号登录后将自动注册</p>\n        </div>\n\n        <div class=\"form\">\n          <div class=\"form-item\">\n            <input\n              class=\"inp\"\n              maxlength=\"11\"\n              placeholder=\"请输入手机号码\"\n              type=\"text\"\n              v-model=\"mobile\"\n            />\n          </div>\n          <div class=\"form-item\">\n            <input\n              class=\"inp\"\n              maxlength=\"5\"\n              placeholder=\"请输入图形验证码\"\n              type=\"text\"\n              v-model=\"picCode\"\n            />\n            <img\n              :src=\"picUrl\"\n              alt=\"\"\n              @click=\"getPicCode\"\n            />\n          </div>\n          <div class=\"form-item\">\n            <input\n              class=\"inp\"\n              placeholder=\"请输入短信验证码\"\n              type=\"text\"\n              v-model=\"msgCode\"\n            />\n            <button @click=\"getCode\">\n              {{\n                totalSecond === second\n                  ? '获取验证码'\n                  : '重新发送(' + second + '秒)'\n              }}\n            </button>\n          </div>\n        </div>\n\n        <div\n          class=\"login-btn\"\n          @click=\"login\"\n        >\n          登录\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getPicCode, getMsgCode, codeLogin } from '@/api/login'\nexport default {\n  name: 'LoginPage',\n  components: {},\n  data() {\n    return {\n      picUrl: '', //验证码图片\n      picKey: '', // 验证码密匙\n      totalSecond: 60, // 总秒数\n      second: 60, // 倒计时的秒数\n      timer: null, // 定时器 id\n      picCode: 'aaaa', //图形验证码\n      mobile: '19191919191', //手机号\n      msgCode: '246810',\n    }\n  },\n  methods: {\n    async login() {\n      //1.正则不通过就退出\n      if (!this.validFn()) return\n      console.log('登录')\n\n      if (!/^\\d{6}$/.test(this.msgCode)) {\n        this.$toast('请输入正确的手机验证码')\n        return\n      }\n\n      const res = await codeLogin(this.mobile, this.msgCode)\n      console.log(res)\n      this.$store.commit('user/setUserInfo', res.data)\n\n      console.log('登录成功')\n\n      this.$toast('登录成功')\n      console.log(this.$route)\n      this.$router.go(-1)\n    },\n    validFn() {\n      return true\n      // if (!/^1[3-9]\\d{9}$/.test(this.mobile)) {\n      //   this.$toast('请输入正确的手机号')\n      //   return false\n      // }\n      // if (!/^\\w{4}$/.test(this.picCode)) {\n      //   this.$toast('请输入正确的图形验证码')\n      //   return false\n      // }\n      // return true\n    },\n\n    async getPicCode() {\n      // this.$toast('验证码刷新')\n      const toast1 = this.$toast.loading({\n        message: '加载中...',\n        forbidClick: true,\n        duration: 0,\n      })\n      const {\n        data: { base64, key },\n      } = await getPicCode()\n      console.log(666)\n\n      this.picUrl = base64\n      this.picKey = key\n      // console.log(this.picUrl, this.picKey)\n      toast1.clear()\n    },\n    async getCode() {\n      //1.正则不通过就退出\n      if (!this.validFn()) return\n      //2.如果倒计时没结束也退出\n      if (this.timer || this.second != this.totalSecond) {\n        this.$toast('别急')\n        return\n      }\n      console.log('发送手机验证码')\n      // 发送请求，获取验证码\n      this.$toast.loading({\n        message: '发送手机验证码',\n        forbidClick: true,\n        duration: 0,\n      })\n      await getMsgCode(this.picCode, this.picKey, this.mobile)\n      this.timer = setInterval(() => {\n        this.second--\n        if (this.second < 1) {\n          clearInterval(this.timer)\n          this.timer = null\n          this.second = this.totalSecond\n        }\n      }, 1000)\n      this.$toast('发送成功，请注意查收')\n    },\n  },\n  async created() {\n    this.getPicCode()\n  },\n  destroyed() {\n    //离开页面时销毁可能存在的计时器对象\n    clearInterval(this.timer)\n  },\n}\n</script>\n<style lang=\"less\" scoped>\n.container {\n  padding: 49px 29px;\n\n  .title {\n    margin-bottom: 20px;\n    h3 {\n      font-size: 26px;\n      font-weight: normal;\n    }\n    p {\n      line-height: 40px;\n      font-size: 14px;\n      color: #b8b8b8;\n    }\n  }\n\n  .form-item {\n    border-bottom: 1px solid #f3f1f2;\n    padding: 8px;\n    margin-bottom: 14px;\n    display: flex;\n    align-items: center;\n    .inp {\n      display: block;\n      border: none;\n      outline: none;\n      height: 32px;\n      font-size: 14px;\n      flex: 1;\n    }\n    img {\n      width: 94px;\n      height: 31px;\n    }\n    button {\n      height: 31px;\n      border: none;\n      font-size: 13px;\n      color: #cea26a;\n      background-color: transparent;\n      padding-right: 9px;\n    }\n  }\n\n  .login-btn {\n    width: 100%;\n    height: 42px;\n    margin-top: 39px;\n    background: linear-gradient(90deg, #ecb53c, #ff9211);\n    color: #fff;\n    border-radius: 39px;\n    box-shadow: 0 10px 20px 0 rgba(0, 0, 0, 0.1);\n    letter-spacing: 2px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1b8b2b21&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1b8b2b21&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1b8b2b21\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","on","$event","$router","go","staticClass","_m","directives","name","rawName","value","mobile","expression","domProps","target","composing","picCode","picUrl","getPicCode","msgCode","getCode","_v","_s","totalSecond","second","login","staticRenderFns","request","get","getMsgCode","captchaCode","captchaKey","post","form","codeLogin","smsCode","isParty","partyData","components","data","picKey","timer","methods","validFn","console","log","test","$toast","res","$store","commit","$route","toast1","loading","message","forbidClick","duration","base64","key","clear","setInterval","clearInterval","created","destroyed","component"],"sourceRoot":""}